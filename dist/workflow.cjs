var e=require("xstate"),t=require("events");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i.apply(this,arguments)}var r=function(t){this.machine=void 0,this.machine=e.createMachine(i({predictableActionArguments:!0,id:"fhir-workflow-fsm"},t,{strict:!0}))},o=function(e){this.resourceType=void 0,this.resource=void 0,this.intent=void 0,this.status=void 0,this.createdAt=void 0,this.resourceType="Task",this.resource=i({intent:"unknown",status:"draft",resourceType:this.resourceType},e),this.createdAt=new Date,this.intent="unknown",this.status="draft"},s=new(/*#__PURE__*/n(t).default),a=/*#__PURE__*/function(){function t(t){var n;this.name=void 0,this.createdAt=void 0,this.fsm=void 0,this.task=void 0,this.ee=void 0,this.name=t,this.createdAt=new Date,this.fsm=(n=new r({id:"task",initial:"draft",context:{retries:0},states:{draft:{on:{READY:"ready",REQUEST:"requested",CANCEL:"cancelled"}},ready:{on:{RESOLVE:"in-progress"}},requested:{on:{ACCEPT:"accepted",REJECT:"rejected",RECEIVE:"received"}},received:{on:{ACCEPT:"accepted",REJECT:"rejected"}},rejected:{on:{STOP:"done"}},accepted:{on:{RESOLVE:"in-progress"}},"in-progress":{on:{HOLD:"on-hold",COMPLETE:"completed",FAILED:"failed"}},completed:{on:{STOP:"done"}},failed:{on:{STOP:"done"}},"on-hold":{on:{UNHOLD:"in-progress"}},cancelled:{on:{STOP:"done"}},done:{type:"final"}}}),e.interpret(n.machine)),this.task=new o({intent:"unknown",status:"draft"}),this.ee=s}var n=t.prototype;return n.start=function(){this.ee.emit("start",this),this.fsm.start()},n.on=function(e,t){this.ee.on(e,t)},t}();exports.Workflow=a,exports.workflow=function(e){return void 0!==e&&""!==e||(e="my-workflow"),new a(e)};
